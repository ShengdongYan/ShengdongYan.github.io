<!-- build time:Tue Jul 09 2019 18:45:12 GMT+0100 (GMT+01:00) --><!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no,minimal-ui"><meta name="renderer" content="webkit"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="format-detection" content="telephone=no,email=no,adress=no"><meta name="theme-color" content="#000000"><meta http-equiv="window-target" content="_top"><title>Mybastis学习及使用笔记 | 东东东的小站</title><meta name="description" content="概述Mybatis是一个优秀的基于 java的持久层框架，它内部封装了 jdbc，使开发者只需要关注 sql语句本身，而不需要花费精力去处理加载驱动、创建连接、创建 statement等繁杂的过程。mybatis通过 xml或注解的方式将要执行的各种 statement配置起来，并通过 java对象和 statement中sql的动态参数进行映射生成最终执行的 sql语句，最后由 mybatis框"><meta name="keywords" content="Mybatis"><meta property="og:type" content="article"><meta property="og:title" content="Mybastis学习及使用笔记"><meta property="og:url" content="http://dongdongyan.com/2019/06/02/Mybatis学习及使用笔记/index.html"><meta property="og:site_name" content="东东东的小站"><meta property="og:description" content="概述Mybatis是一个优秀的基于 java的持久层框架，它内部封装了 jdbc，使开发者只需要关注 sql语句本身，而不需要花费精力去处理加载驱动、创建连接、创建 statement等繁杂的过程。mybatis通过 xml或注解的方式将要执行的各种 statement配置起来，并通过 java对象和 statement中sql的动态参数进行映射生成最终执行的 sql语句，最后由 mybatis框"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2019-07-09T15:39:09.430Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Mybastis学习及使用笔记"><meta name="twitter:description" content="概述Mybatis是一个优秀的基于 java的持久层框架，它内部封装了 jdbc，使开发者只需要关注 sql语句本身，而不需要花费精力去处理加载驱动、创建连接、创建 statement等繁杂的过程。mybatis通过 xml或注解的方式将要执行的各种 statement配置起来，并通过 java对象和 statement中sql的动态参数进行映射生成最终执行的 sql语句，最后由 mybatis框"><link rel="canonical" href="http://dongdongyan.com/2019/06/02/Mybatis学习及使用笔记/index.html"><link rel="alternate" href="/atom.xml" title="东东东的小站" type="application/atom+xml"><link rel="icon" href="/images/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/css/style.css"></head><body class="main-center" itemscope itemtype="http://schema.org/WebPage"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="slimContent"><div class="navbar-header"><div class="profile-block text-center"><a id="avatar" href="https://github.com/shengdongyan" target="_blank" rel="external nofollow noopener noreferrer"><img class="img-circle img-rotate" src="/images/avatar.jpg" width="200" height="200"></a><h2 id="name" class="hidden-xs hidden-sm">东东东</h2><h3 id="title" class="hidden-xs hidden-sm hidden-md">A Java Developer</h3><small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i> Birmingham, UK</small></div><div class="search" id="search-form-wrap"><form class="search-form sidebar-form"><div class="input-group"><input type="text" class="search-form-input form-control" placeholder="搜索"> <span class="input-group-btn"><button type="submit" class="search-form-submit btn btn-flat" onclick="return!1"><i class="icon icon-search"></i></button></span></div></form><div class="ins-search"><div class="ins-search-mask"></div><div class="ins-search-container"><div class="ins-input-wrapper"><input type="text" class="ins-search-input" placeholder="想要查找什么..." x-webkit-speech> <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button></div><div class="ins-section-wrapper"><div class="ins-section-container"></div></div></div></div></div><button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false"><span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button></div><nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation"><ul class="nav navbar-nav main-nav"><li class="menu-item menu-item-home"><a href="/."><i class="icon icon-home-fill"></i> <span class="menu-title">首页</span></a></li><li class="menu-item menu-item-archives"><a href="/archives"><i class="icon icon-archives-fill"></i> <span class="menu-title">归档</span></a></li><li class="menu-item menu-item-categories"><a href="/categories"><i class="icon icon-folder"></i> <span class="menu-title">分类</span></a></li><li class="menu-item menu-item-tags"><a href="/tags"><i class="icon icon-tags"></i> <span class="menu-title">标签</span></a></li><li class="menu-item menu-item-repository"><a href="/repository"><i class="icon icon-project"></i> <span class="menu-title">项目</span></a></li><li class="menu-item menu-item-photo"><a href="/photo"><i class="icon icon-book-fill"></i> <span class="menu-title">相册</span></a></li><li class="menu-item menu-item-links"><a href="/links"><i class="icon icon-friendship"></i> <span class="menu-title">友链</span></a></li><li class="menu-item menu-item-about"><a href="/about"><i class="icon icon-cup-fill"></i> <span class="menu-title">关于</span></a></li></ul><ul class="social-links"><li><a href="https://github.com/shengdongyan" target="_blank" title="Github" data-toggle="tooltip" data-placement="top" rel="external nofollow noopener noreferrer"><i class="icon icon-github"></i></a></li><li><a href="https://www.zhihu.com/people/dong-dong-yan-28" target="_blank" title="Zhihu" data-toggle="tooltip" data-placement="top" rel="external nofollow noopener noreferrer"><i class="icon icon-zhihu"></i></a></li><li><a href="https://user.qzone.qq.com/516639611" target="_blank" title="Qzone" data-toggle="tooltip" data-placement="top" rel="external nofollow noopener noreferrer"><i class="icon icon-qzone"></i></a></li><li><a href="https://www.weibo.com/p/1005055828209433/home?from=page_100505&mod=TAB&is_hot=1#place" target="_blank" title="Weibo" data-toggle="tooltip" data-placement="top" rel="external nofollow noopener noreferrer"><i class="icon icon-weibo"></i></a></li><li><a href="https://www.facebook.com/shengdong.yan" target="_blank" title="Facebook" data-toggle="tooltip" data-placement="top" rel="external nofollow noopener noreferrer"><i class="icon icon-facebook"></i></a></li><li><a href="/atom.xml" target="_blank" title="Rss" data-toggle="tooltip" data-placement="top"><i class="icon icon-rss"></i></a></li></ul></nav></div></header><aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar"><div class="slimContent"><div class="widget"><h3 class="widget-title">公告</h3><div class="widget-body"><div id="board"><div class="content"><p style="width:200px">东东东：博主本科毕业于北邮，研究生就读于英国伯明翰大学，即将步入职场，未来希望可以从事Java开发的相关工作。目前主要在这里记录学习笔记和生活随笔，下面是我的微信，欢迎交流与分享经验!</p><br><img class="img-rotate" src="/images/QrCode.jpeg" width="180" height="180"></div></div></div></div><div class="widget"><h3 class="widget-title">分类</h3><div class="widget-body"><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Java/">Java</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/JavaWeb/">JavaWeb</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Mybatis/">Mybatis</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/SpringVC框架/">SpringVC框架</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Spring框架/">Spring框架</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/数据库/">数据库</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/日常随笔/">日常随笔</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/计算机基础知识/">计算机基础知识</a><span class="category-list-count">3</span></li></ul></div></div><div class="widget"><h3 class="widget-title">标签</h3><div class="widget-body"><ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/AOP/">AOP</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Cookie/">Cookie</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Filter/">Filter</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hexo/">Hexo</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hexo主题/">Hexo主题</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/IOC/">IOC</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JavaWeb基础/">JavaWeb基础</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java基础/">Java基础</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java基础，-Collection框架，Java容器/">Java基础， Collection框架，Java容器</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java问题/">Java问题</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Lambda表达式，JDK1-8，Function-Stream/">Lambda表达式，JDK1.8，Function,Stream</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linsener/">Linsener</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mybatis/">Mybatis</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Request/">Request</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Response/">Response</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SE/">SE</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Servlet/">Servlet</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SpringMVC/">SpringMVC</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Spring框架/">Spring框架</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Tomcat/">Tomcat</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/UML/">UML</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/markdown/">markdown</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/trasaction/">trasaction</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/建站/">建站</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/数据库三范式，事物四大特性，隔开级别/">数据库三范式，事物四大特性，隔开级别</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/编程语言/">编程语言</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/计算机基础/">计算机基础</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/计算机基础知识/">计算机基础知识</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/随笔/">随笔</a><span class="tag-list-count">3</span></li></ul></div></div><div class="widget"><h3 class="widget-title">标签云</h3><div class="widget-body tagcloud"><a href="/tags/AOP/" style="font-size:13px">AOP</a> <a href="/tags/Cookie/" style="font-size:13px">Cookie</a> <a href="/tags/Filter/" style="font-size:13px">Filter</a> <a href="/tags/Hexo/" style="font-size:14px">Hexo</a> <a href="/tags/Hexo主题/" style="font-size:13px">Hexo主题</a> <a href="/tags/IOC/" style="font-size:13px">IOC</a> <a href="/tags/JavaWeb基础/" style="font-size:13px">JavaWeb基础</a> <a href="/tags/Java基础/" style="font-size:13px">Java基础</a> <a href="/tags/Java基础，-Collection框架，Java容器/" style="font-size:13px">Java基础， Collection框架，Java容器</a> <a href="/tags/Java问题/" style="font-size:13px">Java问题</a> <a href="/tags/Lambda表达式，JDK1-8，Function-Stream/" style="font-size:13px">Lambda表达式，JDK1.8，Function,Stream</a> <a href="/tags/Linsener/" style="font-size:13px">Linsener</a> <a href="/tags/Mybatis/" style="font-size:13px">Mybatis</a> <a href="/tags/Request/" style="font-size:13px">Request</a> <a href="/tags/Response/" style="font-size:13px">Response</a> <a href="/tags/SE/" style="font-size:13px">SE</a> <a href="/tags/Servlet/" style="font-size:13px">Servlet</a> <a href="/tags/SpringMVC/" style="font-size:13px">SpringMVC</a> <a href="/tags/Spring框架/" style="font-size:13px">Spring框架</a> <a href="/tags/Tomcat/" style="font-size:13px">Tomcat</a> <a href="/tags/UML/" style="font-size:13px">UML</a> <a href="/tags/markdown/" style="font-size:13px">markdown</a> <a href="/tags/trasaction/" style="font-size:13px">trasaction</a> <a href="/tags/建站/" style="font-size:14px">建站</a> <a href="/tags/数据库三范式，事物四大特性，隔开级别/" style="font-size:13px">数据库三范式，事物四大特性，隔开级别</a> <a href="/tags/编程语言/" style="font-size:13px">编程语言</a> <a href="/tags/计算机基础/" style="font-size:13px">计算机基础</a> <a href="/tags/计算机基础知识/" style="font-size:13px">计算机基础知识</a> <a href="/tags/随笔/" style="font-size:13.5px">随笔</a></div></div><div class="widget"><h3 class="widget-title">归档</h3><div class="widget-body"><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">七月 2019</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">六月 2019</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">五月 2019</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">四月 2019</a><span class="archive-list-count">8</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">三月 2019</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">二月 2019</a><span class="archive-list-count">1</span></li></ul></div></div><div class="widget"><h3 class="widget-title">最新文章</h3><div class="widget-body"><ul class="recent-post-list list-unstyled no-thumbnail"><li><div class="item-inner"><p class="item-category"><a class="category-link" href="/categories/Spring框架/">Spring框架</a></p><p class="item-title"><a href="/2019/07/06/Spring框架学习笔记/" class="title">Spring框架学习笔记</a></p><p class="item-date"><time datetime="2019-07-06T15:20:31.000Z" itemprop="datePublished">2019-07-06</time></p></div></li><li><div class="item-inner"><p class="item-category"><a class="category-link" href="/categories/SpringVC框架/">SpringVC框架</a></p><p class="item-title"><a href="/2019/07/06/SpringMVC学习笔记/" class="title">SpringMVC学习笔记</a></p><p class="item-date"><time datetime="2019-07-06T15:20:31.000Z" itemprop="datePublished">2019-07-06</time></p></div></li><li><div class="item-inner"><p class="item-category"><a class="category-link" href="/categories/Java/">Java</a></p><p class="item-title"><a href="/2019/07/01/Java基础知识（持续更新）/" class="title">Java基础知识（持续更新）</a></p><p class="item-date"><time datetime="2019-07-01T15:20:31.000Z" itemprop="datePublished">2019-07-01</time></p></div></li><li><div class="item-inner"><p class="item-category"><a class="category-link" href="/categories/Mybatis/">Mybatis</a></p><p class="item-title"><a href="/2019/06/02/Mybatis学习及使用笔记/" class="title">Mybastis学习及使用笔记</a></p><p class="item-date"><time datetime="2019-06-02T22:34:50.000Z" itemprop="datePublished">2019-06-02</time></p></div></li><li><div class="item-inner"><p class="item-category"><a class="category-link" href="/categories/JavaWeb/">JavaWeb</a></p><p class="item-title"><a href="/2019/05/27/JavaWeb基础知识总结/" class="title">JavaWeb基础知识总结</a></p><p class="item-date"><time datetime="2019-05-27T15:20:31.000Z" itemprop="datePublished">2019-05-27</time></p></div></li></ul></div></div></div></aside><aside class="sidebar sidebar-toc collapse" id="collapseToc" itemscope itemtype="http://schema.org/WPSideBar"><div class="slimContent"><nav id="toc" class="article-toc"><h3 class="toc-title">文章目录</h3></nav></div></aside><main class="main" role="main"><div class="content"><article id="post-Mybatis学习及使用笔记" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting"><div class="article-header"><h1 class="article-title" itemprop="name">Mybastis学习及使用笔记</h1><div class="article-meta"><span class="article-date"><i class="icon icon-calendar-check"></i> <a href="/2019/06/02/Mybatis学习及使用笔记/" class="article-date"><time datetime="2019-06-02T22:34:50.000Z" itemprop="datePublished">2019-06-02</time></a></span> <span class="article-category"><i class="icon icon-folder"></i> <a class="article-category-link" href="/categories/Mybatis/">Mybatis</a></span> <span class="article-tag"><i class="icon icon-tags"></i> <a class="article-tag-link" href="/tags/Mybatis/">Mybatis</a></span> <span class="article-read hidden-xs"><i class="icon icon-eye-fill" aria-hidden="true"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></span> <span class="post-comment"><i class="icon icon-comment"></i> <a href="/2019/06/02/Mybatis学习及使用笔记/#comments" class="article-comment-link">评论</a></span> <span class="post-wordcount hidden-xs" itemprop="wordCount">字数统计: 3.9k(字)</span> <span class="post-readcount hidden-xs" itemprop="timeRequired">阅读时长: 18(分)</span></div></div><div class="article-entry marked-body" itemprop="articleBody"><ol><li><p>概述<br>Mybatis是一个优秀的基于 java的持久层框架，它内部封装了 jdbc，使开发者只需要关注 sql语句本身，而不需要花费精力去处理加载驱动、创建连接、创建 statement等繁杂的过程。<br>mybatis通过 xml或注解的方式将要执行的各种 statement配置起来，并通过 java对象和 statement中sql的动态参数进行映射生成最终执行的 sql语句，最后由 mybatis框架执行 sql并将结果映射为 java对象并返回。<br>采用 ORM思想解决了实体和数据库映射的问题，对 jdbc进行了封装，屏蔽了 jdbc api底层访问细节，使我们不用与 jdbc api打交道，就可以完成对数据库的持久化操作。<br>为了我们能够更好掌握框架运行的内部过程，并且有更好的体验，下面我们将从自定义 Mybatis 框架开始来学习框架。此时我们将会体验框架从无到有的过程体验，也能够很好的综合前面阶段所学的基础。</p></li><li><p>传统JDBC的不便：</p><p>1.数据库链接创建、释放频繁造成系统资源浪费从而影响系统性能，如果使用数据库链接池可解决此问题。<br>2.Sql语句在代码中硬编码，造成代码不易维护，实际应用 sql 变化的可能较大，sql 变动需要改变 java代码。<br>3.使用 preparedStatement向占有位符号传参数存在硬编码，因为 sql语句的 where条件不一定，可能多也可能少，修改 sql还要修改代码， 系统不易维护。<br>4.对结果集解析存在硬编码（查询列名），sql 变化导致解析代码变化，系统不易维护，如果能将数据库记录封装成 pojo对象解析比较方便。</p></li><li><p>WEB的三层架构：</p><ol><li>表现层(presentation)： 用于展示数据， 常见框架：SpringMVC ; (Spring框架对每一个都有涉及，不属于某一个)</li><li>业务层(service)： 处理业务需求</li><li>持久层(duration)： 和数据库交互 常见框架: Mybatis</li></ol></li><li><p>JDBC持久层解决方案：</p><ol><li><p>传统JDBC：Connection+ PreparedStatement + ResultSetm（课件里有代码）</p></li><li><p>Spring里的JDBCtemplate : 对JDBC简单的封装</p></li><li>Apache的DButil: 对JDBC简单的封装</li><li>阿里的durid: 数据库连接池</li></ol></li><li><p>MyBatis 好处：</p><ol><li>封装好了设置驱动，连接建立，语句书写以及执行等事物，让我们可以更专注于sql语句的编写。<ol start="2"><li>ORM思想： Object Relational Mapping: 对象关系映射， 简单的说就是把对象和数据库表练习起来，让我们操作对象就像操作数据库， 我们需要让实体类中的字段名和数据库中的字段名一致。</li></ol></li></ol></li></ol><ol start="6"><li><p>Maybatis环境搭建步骤：</p><ol><li>Maven工程并导入坐标依赖</li><li>创建实体类和Dao</li><li>配置环境依赖：SqlMapConfig.xml</li><li>配置映射配置，一个是针对每个Dao的 IUserDao.xml（针对每个Dao的mapper）(也可以用注解配置)</li><li>（如果用注解），去除IUserDao.xml在IUserDao.java的findAll方法上用SELECT注解，并且把SqlMapConfig里的map属性改成Class属性</li></ol></li><li><p>配置时的注意事项</p><ol start="6"><li>mapper的位置目录结构要和Dao.java的目录结构一样</li><li>mapper里的<mapper>里 namespace里的值必须是dao接口的全限定类名</mapper></li><li>mapper里的操作标签里的id取值要是Dao里的方法名<br>遵从了这几点，就不用再写Dao的实现类</li></ol></li></ol><ol start="8"><li>CRUD代码展示</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br></pre></td><td class="code"><pre><span class="line">//1. SqlMapConfig.xml</span><br><span class="line"></span><br><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE configuration</span><br><span class="line">        PUBLIC &quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span><br><span class="line">        &quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;configuration&gt;</span><br><span class="line">    &lt;!-- 配置环境 --&gt;</span><br><span class="line">    &lt;environments default=&quot;mysql&quot;&gt;</span><br><span class="line">        &lt;environment id=&quot;mysql&quot;&gt;</span><br><span class="line">            &lt;transactionManager type=&quot;JDBC&quot;&gt;&lt;/transactionManager&gt;</span><br><span class="line">            &lt;!-- 有连接池--&gt;</span><br><span class="line">            &lt;dataSource type=&quot;POOLED&quot;&gt;</span><br><span class="line">                &lt;!-- 四个基本信息--&gt;</span><br><span class="line">                &lt;property name=&quot;driver&quot; value=&quot;com.mysql.cj.jdbc.Driver&quot;/&gt;</span><br><span class="line">                &lt;property name=&quot;url&quot; value=&quot;jdbc:mysql://localhost:3306/eesy_mybatis&quot;/&gt;</span><br><span class="line">                &lt;property name=&quot;username&quot; value=&quot;root&quot;/&gt;</span><br><span class="line">                &lt;property name=&quot;password&quot; value=&quot;Yanshengdong123&quot;/&gt;</span><br><span class="line">            &lt;/dataSource&gt;</span><br><span class="line">        &lt;/environment&gt;</span><br><span class="line">    &lt;/environments&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;!-- 每个Dao独立的配置文件,每个都是一个mapper--&gt;</span><br><span class="line">    &lt;mappers&gt;</span><br><span class="line">       &lt;!--&lt;mapper resource=&quot;com/itheima/dao/IUserDao.xml&quot;&gt;&lt;/mapper&gt;--&gt;</span><br><span class="line">        &lt;!-- package标签是用于指定dao接口所在的包,当指定了之后就不需要在写mapper以及resource或者class了 --&gt;</span><br><span class="line">        &lt;package name=&quot;com.itheima.dao&quot;&gt;&lt;/package&gt;   &lt;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/mappers&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//2.IUserDao.xml</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE mapper</span><br><span class="line">        PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span><br><span class="line">        &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;</span><br><span class="line">&lt;mapper namespace=&quot;com.itheima.dao.IUserDao&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 配置 查询结果的列名和实体类的属性名的对应关系 --&gt;</span><br><span class="line">    &lt;resultMap id=&quot;userMap&quot; type=&quot;uSeR&quot;&gt;</span><br><span class="line">        &lt;!-- 主键字段的对应 --&gt;</span><br><span class="line">        &lt;id property=&quot;userId&quot; column=&quot;id&quot;&gt;&lt;/id&gt;</span><br><span class="line">        &lt;!--非主键字段的对应--&gt;</span><br><span class="line">        &lt;result property=&quot;userName&quot; column=&quot;username&quot;&gt;&lt;/result&gt;</span><br><span class="line">        &lt;result property=&quot;userAddress&quot; column=&quot;address&quot;&gt;&lt;/result&gt;</span><br><span class="line">        &lt;result property=&quot;userSex&quot; column=&quot;sex&quot;&gt;&lt;/result&gt;</span><br><span class="line">        &lt;result property=&quot;userBirthday&quot; column=&quot;birthday&quot;&gt;&lt;/result&gt;</span><br><span class="line">    &lt;/resultMap&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;!-- 查询所有 --&gt;</span><br><span class="line">    &lt;select id=&quot;findAll&quot; resultMap=&quot;userMap&quot;&gt;</span><br><span class="line">        &lt;!--select id as userId,username as userName,address as userAddress,sex as userSex,birthday as userBirthday from user;--&gt;</span><br><span class="line">        select * from user;</span><br><span class="line">    &lt;/select&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 保存用户 --&gt;</span><br><span class="line">    &lt;insert id=&quot;saveUser&quot; parameterType=&quot;user&quot;&gt;</span><br><span class="line">        &lt;!-- 配置插入操作后，获取插入数据的id --&gt;</span><br><span class="line">        &lt;selectKey keyProperty=&quot;userId&quot; keyColumn=&quot;id&quot; resultType=&quot;int&quot; order=&quot;AFTER&quot;&gt;</span><br><span class="line">            select last_insert_id();</span><br><span class="line">        &lt;/selectKey&gt;</span><br><span class="line">        insert into user(username,address,sex,birthday)values(#&#123;userName&#125;,#&#123;userAddress&#125;,#&#123;userSex&#125;,#&#123;userBirthday&#125;);</span><br><span class="line">    &lt;/insert&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 更新用户 --&gt;</span><br><span class="line">    &lt;update id=&quot;updateUser&quot; parameterType=&quot;USER&quot;&gt;</span><br><span class="line">        update user set username=#&#123;userName&#125;,address=#&#123;userAddress&#125;,sex=#&#123;userAex&#125;,birthday=#&#123;userBirthday&#125; where id=#&#123;userId&#125;</span><br><span class="line">    &lt;/update&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 删除用户--&gt;</span><br><span class="line">    &lt;delete id=&quot;deleteUser&quot; parameterType=&quot;java.lang.Integer&quot;&gt;</span><br><span class="line">        delete from user where id = #&#123;uid&#125;</span><br><span class="line">    &lt;/delete&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;!-- 根据id查询用户 --&gt;</span><br><span class="line">    &lt;select id=&quot;findById&quot; parameterType=&quot;INT&quot; resultMap=&quot;userMap&quot;&gt;</span><br><span class="line">        select * from user where id = #&#123;uid&#125;</span><br><span class="line">    &lt;/select&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 根据名称模糊查询 --&gt;</span><br><span class="line">    &lt;select id=&quot;findByName&quot; parameterType=&quot;string&quot; resultMap=&quot;userMap&quot;&gt;</span><br><span class="line">          select * from user where username like #&#123;name&#125;</span><br><span class="line">        &lt;!-- select * from user where username like &apos;%$&#123;value&#125;%&apos;--&gt;</span><br><span class="line">   &lt;/select&gt;</span><br><span class="line"></span><br><span class="line">    &lt;!-- 获取用户的总记录条数 --&gt;</span><br><span class="line">    &lt;select id=&quot;findTotal&quot; resultType=&quot;int&quot;&gt;</span><br><span class="line">        select count(id) from user;</span><br><span class="line">    &lt;/select&gt;</span><br><span class="line">    &lt;!-- 根据queryVo的条件查询用户 --&gt;</span><br><span class="line">    &lt;select id=&quot;findUserByVo&quot; parameterType=&quot;com.itheima.domain.QueryVo&quot; resultMap=&quot;userMap&quot;&gt;</span><br><span class="line">        select * from user where username like #&#123;user.username&#125;</span><br><span class="line">    &lt;/select&gt;</span><br><span class="line">&lt;/mapper&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//3.log4j.properties</span><br><span class="line"></span><br><span class="line"># Set root category priority to INFO and its only appender to CONSOLE.</span><br><span class="line">#log4j.rootCategory=INFO, CONSOLE            debug   info   warn error fatal</span><br><span class="line">log4j.rootCategory=debug, CONSOLE, LOGFILE</span><br><span class="line"></span><br><span class="line"># Set the enterprise logger category to FATAL and its only appender to CONSOLE.</span><br><span class="line">log4j.logger.org.apache.axis.enterprise=FATAL, CONSOLE</span><br><span class="line"></span><br><span class="line"># CONSOLE is set to be a ConsoleAppender using a PatternLayout.</span><br><span class="line">log4j.appender.CONSOLE=org.apache.log4j.ConsoleAppender</span><br><span class="line">log4j.appender.CONSOLE.layout=org.apache.log4j.PatternLayout</span><br><span class="line">log4j.appender.CONSOLE.layout.ConversionPattern=%d&#123;ISO8601&#125; %-6r [%15.15t] %-5p %30.30c %x - %m\n</span><br><span class="line"></span><br><span class="line"># LOGFILE is set to be a File appender using a PatternLayout.</span><br><span class="line">log4j.appender.LOGFILE=org.apache.log4j.FileAppender</span><br><span class="line">log4j.appender.LOGFILE.File=d:\axis.log</span><br><span class="line">log4j.appender.LOGFILE.Append=true</span><br><span class="line">log4j.appender.LOGFILE.layout=org.apache.log4j.PatternLayout</span><br><span class="line">log4j.appender.LOGFILE.layout.ConversionPattern=%d&#123;ISO8601&#125; %-6r [%15.15t] %-5p %30.30c %x - %m\n</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//4.IUserDao</span><br><span class="line"></span><br><span class="line">package com.itheima.dao;</span><br><span class="line"></span><br><span class="line">import com.itheima.domain.QueryVo;</span><br><span class="line">import com.itheima.domain.User;</span><br><span class="line"></span><br><span class="line">import java.util.List;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * @author 黑马程序员</span><br><span class="line"> * @Company http://www.ithiema.com</span><br><span class="line"> *</span><br><span class="line"> * 用户的持久层接口</span><br><span class="line"> */</span><br><span class="line">public interface IUserDao &#123;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 查询所有用户</span><br><span class="line">     * @return</span><br><span class="line">     */</span><br><span class="line">    List&lt;User&gt; findAll();</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 保存用户</span><br><span class="line">     * @param user</span><br><span class="line">     */</span><br><span class="line">    void saveUser(User user);</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 更新用户</span><br><span class="line">     * @param user</span><br><span class="line">     */</span><br><span class="line">    void updateUser(User user);</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 根据Id删除用户</span><br><span class="line">     * @param userId</span><br><span class="line">     */</span><br><span class="line">    void deleteUser(Integer userId);</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 根据id查询用户信息</span><br><span class="line">     * @param userId</span><br><span class="line">     * @return</span><br><span class="line">     */</span><br><span class="line">    User findById(Integer userId);</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 根据名称模糊查询用户信息</span><br><span class="line">     * @param username</span><br><span class="line">     * @return</span><br><span class="line">     */</span><br><span class="line">    List&lt;User&gt; findByName(String username);</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 查询总用户数</span><br><span class="line">     * @return</span><br><span class="line">     */</span><br><span class="line">    int findTotal();</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 根据queryVo中的条件查询用户</span><br><span class="line">     * @param vo</span><br><span class="line">     * @return</span><br><span class="line">     */</span><br><span class="line">    List&lt;User&gt; findUserByVo(QueryVo vo);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//5.test</span><br><span class="line"></span><br><span class="line">package com.itheima.test;</span><br><span class="line"></span><br><span class="line">import com.itheima.dao.IUserDao;</span><br><span class="line">import com.itheima.domain.QueryVo;</span><br><span class="line">import com.itheima.domain.User;</span><br><span class="line">import org.apache.ibatis.io.Resources;</span><br><span class="line">import org.apache.ibatis.session.SqlSession;</span><br><span class="line">import org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line">import org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line">import org.junit.After;</span><br><span class="line">import org.junit.Before;</span><br><span class="line">import org.junit.Test;</span><br><span class="line"></span><br><span class="line">import java.io.InputStream;</span><br><span class="line">import java.util.Date;</span><br><span class="line">import java.util.List;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * @author 黑马程序员</span><br><span class="line"> * @Company http://www.ithiema.com</span><br><span class="line"> *</span><br><span class="line"> * 测试mybatis的crud操作</span><br><span class="line"> */</span><br><span class="line">public class MybatisTest &#123;</span><br><span class="line"></span><br><span class="line">    private InputStream in;</span><br><span class="line">    private SqlSession sqlSession;</span><br><span class="line">    private IUserDao userDao;</span><br><span class="line"></span><br><span class="line">    @Before//用于在测试方法执行之前执行</span><br><span class="line">    public void init()throws Exception&#123;</span><br><span class="line">        //1.读取配置文件，生成字节输入流</span><br><span class="line">        in = Resources.getResourceAsStream(&quot;SqlMapConfig.xml&quot;);</span><br><span class="line">        //2.获取SqlSessionFactory</span><br><span class="line">        SqlSessionFactory factory = new SqlSessionFactoryBuilder().build(in);</span><br><span class="line">        //3.获取SqlSession对象</span><br><span class="line">        sqlSession = factory.openSession();</span><br><span class="line">        //4.获取dao的代理对象</span><br><span class="line">        userDao = sqlSession.getMapper(IUserDao.class);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @After//用于在测试方法执行之后执行</span><br><span class="line">    public void destroy()throws Exception&#123;</span><br><span class="line">        //提交事务</span><br><span class="line">        sqlSession.commit();</span><br><span class="line">        //6.释放资源</span><br><span class="line">        sqlSession.close();</span><br><span class="line">        in.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 测试查询所有</span><br><span class="line">     */</span><br><span class="line">    @Test</span><br><span class="line">    public void testFindAll()&#123;</span><br><span class="line">        //5.执行查询所有方法</span><br><span class="line">        List&lt;User&gt; users = userDao.findAll();</span><br><span class="line">        for(User user : users)&#123;</span><br><span class="line">            System.out.println(user);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 测试保存操作</span><br><span class="line">     */</span><br><span class="line">    @Test</span><br><span class="line">    public void testSave()&#123;</span><br><span class="line">        User user = new User();</span><br><span class="line">        user.setUserName(&quot;modify User property&quot;);</span><br><span class="line">        user.setUserAddress(&quot;北京市顺义区&quot;);</span><br><span class="line">        user.setUserSex(&quot;男&quot;);</span><br><span class="line">        user.setUserBirthday(new Date());</span><br><span class="line">        System.out.println(&quot;保存操作之前：&quot;+user);</span><br><span class="line">        //5.执行保存方法</span><br><span class="line">        userDao.saveUser(user);</span><br><span class="line"></span><br><span class="line">        System.out.println(&quot;保存操作之后：&quot;+user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 测试更新操作</span><br><span class="line">     */</span><br><span class="line">    @Test</span><br><span class="line">    public void testUpdate()&#123;</span><br><span class="line">        User user = new User();</span><br><span class="line">        user.setUserId(50);</span><br><span class="line">        user.setUserName(&quot;mybastis update user&quot;);</span><br><span class="line">        user.setUserAddress(&quot;北京市顺义区&quot;);</span><br><span class="line">        user.setUserSex(&quot;女&quot;);</span><br><span class="line">        user.setUserBirthday(new Date());</span><br><span class="line"></span><br><span class="line">        //5.执行保存方法</span><br><span class="line">        userDao.updateUser(user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 测试删除操作</span><br><span class="line">     */</span><br><span class="line">    @Test</span><br><span class="line">    public void testDelete()&#123;</span><br><span class="line">        //5.执行删除方法</span><br><span class="line">        userDao.deleteUser(48);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 测试删除操作</span><br><span class="line">     */</span><br><span class="line">    @Test</span><br><span class="line">    public void testFindOne()&#123;</span><br><span class="line">        //5.执行查询一个方法</span><br><span class="line">        User  user = userDao.findById(50);</span><br><span class="line">        System.out.println(user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 测试模糊查询操作</span><br><span class="line">     */</span><br><span class="line">    @Test</span><br><span class="line">    public void testFindByName()&#123;</span><br><span class="line">        //5.执行查询一个方法</span><br><span class="line">        List&lt;User&gt; users = userDao.findByName(&quot;%王%&quot;); // 因为 like 语法里需要 like %王%； 所以要手动加</span><br><span class="line">//        List&lt;User&gt; users = userDao.findByName(&quot;王&quot;);</span><br><span class="line">        for(User user : users)&#123;</span><br><span class="line">            System.out.println(user);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 测试查询总记录条数</span><br><span class="line">     */</span><br><span class="line">    @Test</span><br><span class="line">    public void testFindTotal()&#123;</span><br><span class="line">        //5.执行查询一个方法</span><br><span class="line">        int count = userDao.findTotal();</span><br><span class="line">        System.out.println(count);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 测试使用QueryVo作为查询条件</span><br><span class="line">     */</span><br><span class="line">    @Test</span><br><span class="line">    public void testFindByVo()&#123;</span><br><span class="line">        QueryVo vo = new QueryVo();</span><br><span class="line">        User user = new User();</span><br><span class="line">        user.setUserName(&quot;%王%&quot;);</span><br><span class="line">        vo.setUser(user);</span><br><span class="line">        //5.执行查询一个方法</span><br><span class="line">        List&lt;User&gt; users = userDao.findUserByVo(vo);</span><br><span class="line">        for(User u : users)&#123;</span><br><span class="line">            System.out.println(u);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="9"><li>OGNL表达式：</li></ol><p>Object &emsp; Graphic &emsp; Navigation &emsp; Language</p><p>对象 &emsp;&emsp; 图 &emsp;&emsp;&emsp;&emsp;&emsp; 导航 &emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; 语言</p><p>包装pojo对象实现综合条件查询</p><ol start="10"><li>自定义实体类和数据库中字段名必须保持一致的问题，</li></ol><p>如果不保持一致，就要在IUserDao.xml中配置对应的 resultmap属性如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;resultMap id=&quot;userMap&quot; type=&quot;uSeR&quot;&gt;</span><br><span class="line">    &lt;!-- 主键字段的对应 --&gt;</span><br><span class="line">    &lt;id property=&quot;userId&quot; column=&quot;id&quot;&gt;&lt;/id&gt;</span><br><span class="line">    &lt;!--非主键字段的对应--&gt;</span><br><span class="line">    &lt;result property=&quot;userName&quot; column=&quot;username&quot;&gt;&lt;/result&gt;</span><br><span class="line">    &lt;result property=&quot;userAddress&quot; column=&quot;address&quot;&gt;&lt;/result&gt;</span><br><span class="line">    &lt;result property=&quot;userSex&quot; column=&quot;sex&quot;&gt;&lt;/result&gt;</span><br><span class="line">    &lt;result property=&quot;userBirthday&quot; column=&quot;birthday&quot;&gt;&lt;/result&gt;</span><br><span class="line">&lt;/resultMap&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;!-- 查询所有 --&gt;</span><br><span class="line">&lt;select id=&quot;findAll&quot; resultMap=&quot;userMap&quot;&gt;</span><br><span class="line">    &lt;!--select id as userId,username as userName,address as userAddress,sex as userSex,birthday as userBirthday from user;--&gt;</span><br><span class="line">    select * from user;</span><br><span class="line">&lt;/select&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 保存用户 --&gt;</span><br><span class="line">&lt;insert id=&quot;saveUser&quot; parameterType=&quot;user&quot;&gt;</span><br><span class="line">    &lt;!-- 配置插入操作后，获取插入数据的id --&gt;</span><br><span class="line">    &lt;selectKey keyProperty=&quot;userId&quot; keyColumn=&quot;id&quot; resultType=&quot;int&quot; order=&quot;AFTER&quot;&gt;</span><br><span class="line">        select last_insert_id();</span><br><span class="line">    &lt;/selectKey&gt;</span><br><span class="line">    insert into user(username,address,sex,birthday)values(#&#123;userName&#125;,#&#123;userAddress&#125;,#&#123;userSex&#125;,#&#123;userBirthday&#125;);</span><br><span class="line">&lt;/insert&gt;</span><br></pre></td></tr></table></figure><p>如果不改可以用起别名的方式如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;select id=&quot;findAll&quot; resultType=&quot;com.itheima.domain.User&quot;&gt;</span><br><span class="line">    &lt;!--select id as userId,username as userName,address as userAddress,sex as userSex,birthday as userBirthday from user;--&gt;</span><br><span class="line">    select * from user;</span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure><ol start="11"><li>Mybatis也可以通过外部资源 .property 文件的方式来加载配置</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 配置properties</span><br><span class="line">    可以在标签内部配置连接数据库的信息。也可以通过属性引用外部配置文件信息</span><br><span class="line">    resource属性： 常用的</span><br><span class="line">        用于指定配置文件的位置，是按照类路径的写法来写，并且必须存在于类路径下。</span><br><span class="line">    url属性：</span><br><span class="line">        是要求按照Url的写法来写地址</span><br><span class="line">        URL：Uniform Resource Locator 统一资源定位符。它是可以唯一标识一个资源的位置。</span><br><span class="line">        它的写法：</span><br><span class="line">            http://localhost:8080/mybatisserver/demo1Servlet</span><br><span class="line">            协议      主机     端口       URI</span><br><span class="line"></span><br><span class="line">        URI:Uniform Resource Identifier 统一资源标识符。它是在应用中可以唯一定位一个资源的。</span><br><span class="line">--&gt;</span><br><span class="line">&lt;properties url=&quot;file:///D:/IdeaProjects/day02_eesy_01mybatisCRUD/src/main/resources/jdbcConfig.properties&quot;&gt;</span><br><span class="line">   &lt;!-- &lt;property name=&quot;driver&quot; value=&quot;com.mysql.jdbc.Driver&quot;&gt;&lt;/property&gt;</span><br><span class="line">    &lt;property name=&quot;url&quot; value=&quot;jdbc:mysql://localhost:3306/eesy_mybatis&quot;&gt;&lt;/property&gt;</span><br><span class="line">    &lt;property name=&quot;username&quot; value=&quot;root&quot;&gt;&lt;/property&gt;</span><br><span class="line">    &lt;property name=&quot;password&quot; value=&quot;1234&quot;&gt;&lt;/property&gt;--&gt;</span><br><span class="line">&lt;/properties&gt;</span><br></pre></td></tr></table></figure><ol start="12"><li>别名标签和package标签</li></ol><pre><code>&lt;typeAliases&gt;
    &lt;!--typeAlias用于配置别名。type属性指定的是实体类全限定类名。alias属性指定别名，当指定了别名就再区分大小写 
    &lt;typeAlias type=&quot;com.itheima.domain.User&quot; alias=&quot;user&quot;&gt;&lt;/typeAlias&gt;--&gt;

    &lt;!-- 用于指定要配置别名的包，当指定之后，该包下的实体类都会注册别名，并且类名就是别名，不再区分大小写--&gt;
    &lt;package name=&quot;com.itheima.domain&quot;&gt;&lt;/package&gt;
&lt;/typeAliases&gt;


   &lt;mappers&gt;
    &lt;!--&lt;mapper resource=&quot;com/itheima/dao/IUserDao.xml&quot;&gt;&lt;/mapper&gt;--&gt;
    &lt;!-- package标签是用于指定dao接口所在的包,当指定了之后就不需要在写mapper以及resource或者class了 --&gt;
    &lt;package name=&quot;com.itheima.dao&quot;&gt;&lt;/package&gt;
&lt;/mappers&gt;
</code></pre><ol start="13"><li><p>数据库连接池</p><p>SqlMapConfig.xml中的datasource中的type属性就是表示用何种方式连接：</p><ol><li>POOLED， 采用的javax.sql.DataSource规范中的连接池，mybatis中有实现的规范方式</li><li>UNPOOLED 最传统的连接方式，没有池的思想</li><li>JNDI 采用服务器中的JNDI技术实现，来获取DataSource对象， 不同的服务器不同，注意，如果不是web活着Maven的War工程，不能使用。</li><li>在Tomcat中采用的是dbcp连接池</li></ol></li></ol><ol start="14"><li>JNDI： Java Naming and Directory Interface: 目的是模仿Windows系统的注册表</li></ol><ol start="15"><li>MyBatis 中的缓存和延迟加载问题：</li></ol><p>有时候需要用到延迟加载， 比如一个用户可能有很多个账户，所以不应该在用不到账户信息时直接把所有账户加载出来。 具体来说，一般在 一对多和多对多的关系表中，我们采用延迟加载技术。 实现的时候都是根据，先查询自己表中的，在需要查询另一个表中的内容的时候，再调用对方表的查询配置。 而不是只用一个查询语句同时查询两个表。可以通过配置实现。</p><ol start="16"><li><p>缓存技术： 减少和数据库的交换次数，提高效率。 当1. 经常查询。 2. 不经常改变的数据时，3.数据的正确与否对最终结果影响不是很大。（比如，汇率等等） 比较适合存入缓存中。</p><ol><li>自带的一级缓存技术， 是对SqlSession的缓存， 当我们查询一次后，会存入Session提供的一块地方，是Map结构。 当我们再次查询同样的数据，会直接从Session中拿出来用。 当SqlSession消失的时候，缓存也会消失。 sqlsession.clearCache();手动清缓存。或者close了Session再开</li></ol><p>2。 二级缓存， 是SqlSessionFactory对象的缓存， 由同一个SqlSessionFactory对象创建的SqlSession对象共享第一个Session的缓存。（需要在多个地方配置，开启二级缓存）</p></li></ol></div><div class="article-footer"><blockquote class="mt-2x"><ul class="post-copyright list-unstyled"><li class="post-copyright-link hidden-xs"><strong>本文链接：</strong> <a href="http://dongdongyan.com/2019/06/02/Mybatis学习及使用笔记/" title="Mybastis学习及使用笔记" target="_blank" rel="external">http://dongdongyan.com/2019/06/02/Mybatis学习及使用笔记/</a></li><li class="post-copyright-license"><strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="http://creativecommons.org/licenses/by/4.0/deed.zh" target="_blank" rel="external nofollow noopener noreferrer">CC BY 4.0 CN协议</a> 许可协议。转载请注明出处！</li></ul></blockquote><div class="panel panel-default panel-badger"><div class="panel-body"><figure class="media"><div class="media-left"><a href="https://github.com/shengdongyan" target="_blank" class="img-burn thumb-sm visible-lg" rel="external nofollow noopener noreferrer"><img src="/images/avatar.jpg" class="img-rounded w-full" alt></a></div><div class="media-body"><h3 class="media-heading"><a href="https://github.com/shengdongyan" target="_blank" rel="external nofollow noopener noreferrer"><span class="text-dark">东东东</span><small class="ml-1x">A Java Developer</small></a></h3><div>热爱技术，享受生活，欢迎来到东东的博客。</div></div></figure></div></div></div></article><section id="comments"><div id="lv-container" data-id="city" data-uid="MTAyMC80MzUzMy8yMDA3Mg=="><noscript>为正常使用来必力评论功能请激活JavaScript</noscript></div></section></div><nav class="bar bar-footer clearfix" data-stick-bottom><div class="bar-inner"><ul class="pager pull-left"><li class="prev"><a href="/2019/07/01/Java基础知识（持续更新）/" title="Java基础知识（持续更新）"><i class="icon icon-angle-left" aria-hidden="true"></i><span>&nbsp;&nbsp;上一篇</span></a></li><li class="next"><a href="/2019/05/27/JavaWeb基础知识总结/" title="JavaWeb基础知识总结"><span>下一篇&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden="true"></i></a></li><li class="toggle-toc"><a class="toggle-btn collapsed" data-toggle="collapse" href="#collapseToc" aria-expanded="false" title="文章目录" role="button"><span>[&nbsp;</span><span>文章目录</span> <i class="text-collapsed icon icon-anchor"></i> <i class="text-in icon icon-close"></i> <span>]</span></a></li></ul><button type="button" class="btn btn-fancy btn-donate pop-onhover bg-gradient-warning" data-toggle="modal" data-target="#donateModal"><span>赏</span></button><div class="bar-right"><div class="share-component" data-sites="weibo,qq,wechat,facebook,twitter" data-mobile-sites="weibo,qq,qzone"></div></div></div></nav><div class="modal modal-center modal-small modal-xs-full fade" id="donateModal" tabindex="-1" role="dialog"><div class="modal-dialog" role="document"><div class="modal-content donate"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><div class="modal-body"><div class="donate-box"><div class="donate-head"><p>感谢您的支持，我会继续努力的!</p></div><div class="tab-content"><div role="tabpanel" class="tab-pane fade active in" id="alipay"><div class="donate-payimg"><img src="/images/donate/WechatIMG8.jpeg" alt="扫码支持" title="扫一扫"></div><p class="text-muted mv">扫码打赏，你说多少就多少</p><p class="text-grey">打开支付宝扫一扫，即可进行扫码打赏哦</p></div><div role="tabpanel" class="tab-pane fade" id="wechatpay"><div class="donate-payimg"><img src="/images/donate/WechatIMG5.jpeg" alt="扫码支持" title="扫一扫"></div><p class="text-muted mv">扫码打赏，你说多少就多少</p><p class="text-grey">打开微信扫一扫，即可进行扫码打赏哦</p></div></div><div class="donate-footer"><ul class="nav nav-tabs nav-justified" role="tablist"><li role="presentation" class="active"><a href="#alipay" id="alipay-tab" role="tab" data-toggle="tab" aria-controls="alipay" aria-expanded="true"><i class="icon icon-alipay"></i> 支付宝</a></li><li role="presentation"><a href="#wechatpay" role="tab" id="wechatpay-tab" data-toggle="tab" aria-controls="wechatpay" aria-expanded="false"><i class="icon icon-wepay"></i> 微信支付</a></li></ul></div></div></div></div></div></div></main><footer class="footer" itemscope itemtype="http://schema.org/WPFooter"><ul class="social-links"><li><a href="https://github.com/shengdongyan" target="_blank" title="Github" data-toggle="tooltip" data-placement="top" rel="external nofollow noopener noreferrer"><i class="icon icon-github"></i></a></li><li><a href="https://www.zhihu.com/people/dong-dong-yan-28" target="_blank" title="Zhihu" data-toggle="tooltip" data-placement="top" rel="external nofollow noopener noreferrer"><i class="icon icon-zhihu"></i></a></li><li><a href="https://user.qzone.qq.com/516639611" target="_blank" title="Qzone" data-toggle="tooltip" data-placement="top" rel="external nofollow noopener noreferrer"><i class="icon icon-qzone"></i></a></li><li><a href="https://www.weibo.com/p/1005055828209433/home?from=page_100505&mod=TAB&is_hot=1#place" target="_blank" title="Weibo" data-toggle="tooltip" data-placement="top" rel="external nofollow noopener noreferrer"><i class="icon icon-weibo"></i></a></li><li><a href="https://www.facebook.com/shengdong.yan" target="_blank" title="Facebook" data-toggle="tooltip" data-placement="top" rel="external nofollow noopener noreferrer"><i class="icon icon-facebook"></i></a></li><li><a href="/atom.xml" target="_blank" title="Rss" data-toggle="tooltip" data-placement="top"><i class="icon icon-rss"></i></a></li></ul><div class="copyright"><div class="publishby">Theme by <a href="https://github.com/cofess" target="_blank" rel="external nofollow noopener noreferrer">cofess </a>base on <a href="https://github.com/cofess/hexo-theme-pure" target="_blank" rel="external nofollow noopener noreferrer">pure</a>.</div></div></footer><script src="//cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script><script>window.jQuery||document.write('<script src="js/jquery.min.js"><\/script>')</script><script src="/js/plugin.min.js"></script><script src="/js/application.js"></script><script>!function(T){var N={TRANSLATION:{POSTS:"文章",PAGES:"页面",CATEGORIES:"分类",TAGS:"标签",UNTITLED:"(未命名)"},ROOT_URL:"/",CONTENT_URL:"/content.json"};T.INSIGHT_CONFIG=N}(window)</script><script src="/js/insight.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script defer type="text/javascript">!function(e,t){var n,c=e.getElementsByTagName(t)[0];"function"!=typeof LivereTower&&(n=e.createElement(t),n.src="https://cdn-city.livere.com/js/embed.dist.js",n.async=!0,c.parentNode.insertBefore(n,c))}(document,"script")</script></body></html><!-- rebuild by neat -->